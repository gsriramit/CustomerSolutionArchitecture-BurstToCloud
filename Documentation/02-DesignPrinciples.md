# Design Principles
## Well-Architected Pillars
![Well-Architected](https://user-images.githubusercontent.com/13979783/233577708-6b9ef965-0ba9-4b92-b4c7-b63b47d99abc.png)  
src: MS Official Documentation on Mission Critical Workloads (https://learn.microsoft.com/en-us/azure/well-architected/mission-critical/mission-critical-design-principles)  

**NOTE:** The official documentation has the design considerations under each of the 5 pillars of the framework. The following tables will explain the considerations that we have adopted in implementing this solution

| Design principle                                                                                                                                      | Considerations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ----------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Active/Active design                                                                                                                                  | The System has Azure as the secondary region to which the overflown traffic would be diverted to. This helps in addressing the availability requirements of the currrent system on-premise. All the components (public IP address, Virtual Machine Scale Sets and Azure SQL DB) have been zone-redundant to improve the availability of the stamp within that region. This solution does not represent a proper active-active model but an active-Hot-Standby model. Azure region which serves as the secondary region that handles the excess application traffic, can also be configured to be the "Fail-over" target of the primary region i.e. on-premise                                                                                                                                                                                                                  |
| [Blast radius reduction and fault isolation](https://learn.microsoft.com/en-us/azure/architecture/framework/resiliency/principles#design-for-failure) | A) Cascading Failures will be avoided wherever possible. FMEA (Failure mode effect analysis ) and Chaos Engineering can help understand the ways in which the system could possibly fail. The Design has to be made in such a way that the system either gracefully degrades or handles the failures though other possible means. \*\*Note\*\*: FMEA and Chaos engineering have not been performed in this solution implementation. B)   Implemetaion of \*\*Resiliency Cloud Design Patterns\*\* at the  aplication level can also help in handling the reduction of the blast radius (This includes the retry and circuit breaker patterns). \*\*Note\*\*:   The patterns have not been implemented in the sample app used                                                                                                                                                   |
| [Observe application health](https://learn.microsoft.com/en-us/azure/architecture/framework/resiliency/principles#observe-application-health)         | We have configured for the application specific logs to be collected in the regional application insights instances. The infrastructure logs are collected in the regional log analytics workspaces. Monitoring the health of the application is implemented by using the \*\*Reliability Health Model\*\* that suggests maintaining the statusses of all the services/components in a system and deciding the health of the system based on the aggregate health of the components. \*\*Note\*\*: The health model has not been implemented in this solution. The official documentation has a reference implementation for AKS based workload. For a worklod that is similar to the one used in this solution, refer to \*\*https://github.com/gsriramit/AzWellArchitected-Reliability/tree/main/HealthModelSystem\*\*                                                       |
| [Drive automation](https://learn.microsoft.com/en-us/azure/architecture/framework/resiliency/principles#drive-automation)                             | As a best practice, the deployment of the stamps, regional monitoring resources and the global resources are through ARM templates. At this point, we use a powershell script that can be used to run the deployment, however we are looking to use Github actions to create deployment pipelines. \*\*Note\*\*: Refer to the Official documentation on the best practices to include \*Unit and Performance Tests\* in the pipeline. This would help in understanding the performance changes in the app with each deployment.                                                                                                                                                                                                                                                                                                                                                |
| [Design for self-healing](https://learn.microsoft.com/en-us/azure/architecture/framework/resiliency/principles#design-for-self-healing)               | The Azure Services by default have been designed to self-heal. Azure manages the way the services operate at times of failure. E.g. 1) Azure public load balancer would by default be provisioned with multiple nodes handling the customer traffic. When one or more nodes (across data centers) degrade, the monitoring platform would be able to understand this issue with the platform and \*spin up additional nodes to maintain the SLA attached to the SKU of the service chosen\*.  2) Based on the concept of \*\*Shared responsibility\*\* for reliability, we are expected to design the services to be highly available. In our solution, VMSS should be configured with a minimum of 2 instances so that the platform would be spinning up new instances if the current set of instances fail<br>                                                                |
| Design for scale-out                                                                                                                                  | Scale-Unit in this solution is represented by all components in a single stamp (in the azure region). The components in the scale unit are expected to scale together when there is an increase in the traffic handled. VMSS is configured for auto-scaling. Azure SQL DB business critical tier is chosen with an appropriate SKU that supports sufficient read and write scale. However scaling up Azure SQL DB has to be automated in response to a monitored performance bottleneck caused by Azure SQL DB. \*\*Note\*\*: If cosmos DB had been the backend, then as a part of the scaling of the scale unit, the \*Request units (RUs)\* would be increased. Also, if the solution had used Application Gateway instead of the Azure external LB, the same should be configured with auto-scaling enabled. This helps maintain the HA of the entire chain i.e. scale unit |


